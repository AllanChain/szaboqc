\chapter{组态相互作用}
上一章我们讲了\hft 近似, 虽然它在很多情形下非常成功, 但也有本身的局限. \hft 比如在预测$\text{N}_2$电离势的顺序时, 就会发生\emph{定性}的错误. 另外, 限制性HF方法无法正确描述分子解离为开壳层产物的过程(比如$\hd\to2\text{H}$). 虽然非限制HF方法可以定性正确地描述解离, 但给出的势能取现却不精确. 本书剩余部分讲述改进\hft 近似的几种办法. 我们会关心如何获得相关能($E_\mathrm{corr}$), 即精确的非相对论能量($\mathscr{E}_0$)与完备基组极限下\hft 能量($E_0$)的差值.
\begin{equation}
E_\mathrm{corr}=\mathscr{E}_0-E_0
\end{equation}
\section{多组态波函数及Full CI矩阵的结构}
\subsection{中间归一化及相关能的表达式}
\section{双激发CI}
\section{计算示例}
\section{自然轨道与单粒子约化密度矩阵}
目前为止我们所涉及的行列式和组态都由一组正则\hft 轨道构成。由此得到的CI展开收敛很慢。但很清楚的一点是，任意单电子基构成的$N$-电子组态都可以用来做CI计算。因此，我们可以问，能否找到一组单电子基，由该基组得到的CI展开比\hft 基下的CI展开收敛更快？若是如此，我们就能用更少的组态得到相同的结果。由P.-O L\"owdin引入的\emph{自然轨道}就构成这样一组基。

为定义自然轨道，先来考虑$N$电子系统的一阶密度矩阵。给定一归一化波函数$\Phi$, 则$\Phi(\mathbf{x}_1,\ldots,\mathbf{x}_N)\Phi^*(\mathbf{x}_1,\ldots,\mathbf{x}_N)\ddx_1\cdots\ddx_N$就是电子在$\mathbf{x}_1$附近的\underline{\underline{空间-自旋}体积元}$\ddx_1$内，与此同时另外一个电子在$\mathbf{x}_2$附近的体积元$\ddx_2$内（直到N个电子为止）的概率。若仅对$\mathbf{x}_1$附近的$\ddx_1$内由一个电子的概率感兴趣，不关心其他电子在何处，则须对所有其他电子的\underline{空间-自旋}坐标作平均，也即，对$\mathbf{x}_2,\mathbf{x}_3,\ldots,\mathbf{x}_N$积分：
\begin{align}
\rho(\mathbf{x}_1) = N \int\ddx_2\cdots\ddx_N \,\, \Phi(\mathbf{x}_1,\ldots,\mathbf{x}_N)\Phi^*(\mathbf{x}_1,\ldots,\mathbf{x}_N)
\end{align}
$\rho(\mathbf{x}_1)$就称作\underline{N-电子系统}内单个电子的\emph{约化密度函数}。式中的归一化因子$N$是为了使对密度的积分等于总电子数：
\begin{align}
\int\ddx_1\,\,\rho(\mathbf{x_1}) = N
\end{align}
现在将密度函数$\rho(\mathbf{x}_1)$推广为密度矩阵$\gamma(\mathbf{x}_1,\mathbf{x}_1')$, 定义如下;
\begin{align}
\label{4.35}
\gamma(\mathbf{x}_1,\mathbf{x}_1') = N \int\ddx_2\cdots\ddx_N \,\, \Phi(\mathbf{x}_1,\mathbf{x}_2,\ldots,\mathbf{x}_N)\Phi^*(\mathbf{x}_1',\mathbf{x}_2,\ldots,\mathbf{x}_N)
\end{align}
这个矩阵$\gamma(\mathbf{x}_1,\mathbf{x}_1')$依赖于两个连续指标，我们把它称作\emph{一阶约化密度矩阵}或\emph{单电子约化密度矩阵}或者直接叫做\emph{一矩阵}。注意，一矩阵在连续表象下的对角元就是电子密度:
\begin{align}
\gamma(\mathbf{x}_1,\mathbf{x}_1) = \rho(\mathbf{x}_1)
\end{align}
由于$\gamma(\mathbf{x}_1,\mathbf{x}_1')$是两个变量的函数，我们可以将它用正交归一的\hft 自旋轨道$\{\chi_i\}$展开为
\begin{align}
\gamma(\mathbf{x}_1,\mathbf{x}_1') = \sum_{ij} \chi_i(\mathbf{x}_1) \gamma_{ij} \chi_j^*(\mathbf{x}_1)'
\label{4.37}
\end{align}
其中
\begin{align}
\gamma_{ij} = \int\ddx_1\ddx_1'\,\,\chi_i^*(\mathbf{x}_1)\gamma(\mathbf{x}_1,\mathbf{x}_1')\chi_j(\mathbf{x}_1')
\end{align}
由$\{\gamma_{ij}\}$构成的矩阵$\gamma$是一矩阵在正交归一基$\{\chi_i\}$下的\underline{离散表示}。

\exercise{证明$\gamma$是Hermitian矩阵.
\Next
证明$\mathrm{tr}\,\gamma=N$.
\Next
考虑单电子算符
\begin{align*}
\mathcal{O}_1 = \sum_{i=1}^{N}h(i)
\end{align*}
\begin{enumerate}[a.]
	\item 证明
	\begin{align*}
	\braket{\Phi|\mathcal{O}_1|\Phi} = \int\ddx_1\,\, [h(\mathbf{x}_1 \gamma(\mathbf{x}_1,\mathbf{x}_1')) ]_{\mathbf{x}_1'=\mathbf{x}_1}
	\end{align*}
	其中的记号$[\,\,]_{\mathbf{x}_1'=\mathbf{x}_1}$的意思是，在$h(\mathbf{x}_1)$作用到$\gamma(\mathbf{x}_1,\mathbf{x}_1')$之后，令$\mathbf{x}_1'$等于$\mathbf{x}_1$.
	\item 证明
	\begin{align*}
	\braket{\Phi|\mathcal{O}_1|\Phi} = \mathrm{tr}\,\mathbf{h}\gamma
	\end{align*}
	其中
	\begin{align*}
	h_{ij} = \braket{i|h|j} = \int\ddx_1\,\, \chi^*(\mathbf{x}_1) h(\mathbf{x}_1) \chi_j(\mathbf{x}_1)
	\end{align*}
	如此，单电子算符的期望值就可以用\underline{一矩阵}表示出来。
\end{enumerate}
}

若$\Phi$是\hft 基态波函数，那么可以从\underline{一矩阵}的定义（式\eqref{4.35}）证明:
\begin{align}
\gamma^\mathrm{HF}(\mathbf{x}_1,\mathbf{x}_1') = \sum_a \chi_a(\mathbf{x}_1)\chi_a^*(\mathbf{x}_1')
\end{align}
其中的求和仅遍及$\Psi_0$中的自旋轨道。如此，HF\underline{一矩阵}的离散表示非常简单——$\gamma^\mathrm{HF}$是对角的，对角元中，对应占据自旋轨道的元素为一，对应非占轨道的元素为零：
\begin{equation}
\begin{aligned}
\gamma_{ij} & =\delta_{ij}&i,j\in\text{占据轨道}\\
            & = 0 &其他\label{4.40} 
\end{aligned}
\end{equation}
$\gamma^\mathrm{HF}$的对角元可以看作占据数：被占自旋轨道的占据数为1，未占轨道的为0.
\exercise{
回忆在二次量子化中，单电子算符写作：
\begin{align*}
\mathcal{O}_1 = \sum_{ij}\braket{i|h|j}\cs_i a_j
\end{align*}
\begin{enumerate}[a.]
	\item 证明
	\begin{align*}
	\gamma_{ij} = \braket{\Phi|\cs_j a_i|\Phi}
	\end{align*}
	\item 证明$\gamma^\mathrm{HF}$的矩阵元由式\eqref{4.40}给出。
\end{enumerate}
}
一般情形下，当$\Phi$不是$\Psi_0$时，\underline{一矩阵}在\hft 自旋轨道下的离散表示\emph{不}是对角的。但是，由于$\gamma$是Hermitian的，所以能够定义一组正交归一基$\{\eta_i\}$(与$\{\chi_i\}$通过酉变换相连)，在它的表示下，\underline{一矩阵}是对角的。这个使$\gamma$对角化的基组中的元素就是\emph{自然轨道}。为使以上过程更加具体，我们从两组正交归一基$\{\eta_i\}$ $\chi_i$的关系开始(见式\eqref{1.63}\eqref{1.65})：
\begin{align}
\chi_i & = \sum_k \eta_k (\mathbf{U^\dagger}_{ki}) = \sum_k \eta_k U^*_{ik}\\
\eta_i & = \sum_k\chi_k U_{ki} \label{4.41}
\end{align}
式中$\mathbf{U}$是酉矩阵。将式\eqref{4.41}带入\eqref{4.37}就得到:
\begin{align}
\gamma(\mathbf{x}_1,\mathbf{x}_1') & = \sum_{ijkl} \eta_k(\mathbf{x}_1) U^*_{ik} \gamma_{ij} U_{jl} \eta_l^*(\mathbf{x}_1')\notag\\
                                   & = \sum_{kl} \eta_k(\mathbf{x}_1) \left( \sum_{ij} (\mathbf{U}^\dagger)_{ki} \gamma_{ij} U_{jl}  \right) \eta_l^*(\mathbf{x}_1)\notag\\
                                   & = \sum_{kl} \eta_k(\mathbf{x}_1) (\mathbf{U}^\dagger \bm{\gamma}\mathbf{U})_{kl} \eta_l^*(\mathbf{x}_1')\notag\\
                                   & = \sum_{kl} \eta_k(\mathbf{x}_1) \lambda_{kl} \eta_l^*(\mathbf{x}_1')
\end{align}
式中我们定义了矩阵
\begin{align}
\bm{\lambda} = \mathbf{U^\dagger}\bm{\gamma}\mathbf{U}
\end{align}
由于$\bm{\gamma}$是Hermitian的，所以能够找到唯一的酉矩阵$\mathbf{U}$使$\bm{\gamma}$对角化，也即
\begin{align}
\lambda_{ij} = \delta_{ij}\lambda_i
\end{align}
对应的自旋轨道$\{\eta_i\}$(由式\eqref{4.42}给出)就是自然自旋轨道。用自然自旋轨道可将式\eqref{4.43}写为：
\begin{align}
\gamma(\mathbf{x}_1,\mathbf{x}_1') = \sum_i \lambda_i \eta_i(\mathbf{x}_1) \eta_i^*(\mathbf{x}_1)
\end{align}
与式\eqref{4.39}中的HF结果类似，$\lambda_i$也叫作\underline{\underline{波函数$\Phi$}中的\underline{自然自旋轨道}}的占据数.

自然轨道的重要性在于, 在某种意义下, 自然轨道给出的是收敛最快的CI展开. 也就是, 给定一个精度, 采用自然轨道来炸开, 所需的组态数量比其他正交归一基所需的更少. 而且往往是占据数最大的那些自然轨道构成的组态对能量的贡献更大. 因此, 若某个\mci{自然自旋轨道}对应的占据数很小, 我们可以从CI展开中去掉它而不明显影响精度.

我们不从数学上证明\mci{自然轨道}就是令CI展开收敛最快的那组基, 而是用一些数值的例子来说明这一点. Shavitt及其合作者做过一项有意思的研究, 用39-STO基(\ref{sec4.3}中提过)计算$\mathrm{H_2O}$. 首先, 他们做了包含4120个\mci{自旋匹配}和\mci
{对称匹配}的单、双激发组态的CI计算, 这些组态都由正则\hft 基生成. 利生成的波函数, 他们得出单粒子密度矩阵并对角化之, 以求得\mci{SDCI近似}下的自然轨道. 接下来, 他们分别用\mci{正则轨道}和\mci{自然轨道}做SDCI计算, 以回答这样一个问题: 为得到某特定百分比的\mci{SDCI关联能}, 至少需要多少个组态? 答案可从\ref{t4.12}中找到。很明显，使用自然轨道构建的\mci{CI展开式}收敛最快。要得到60\%的\mci{SDCI关联能}，若用自然轨道构建组态，则只需50个组态，若用正则轨道，则需140个。但是从表中也可以看到，只有展开项较少的时候，自然轨道相对于正则轨道才有明显优势。需要强调，不同基组下，表中的结果也会不同，可以预见，大基组下，自然轨道和正则轨道之间的差别会更大。

\begin{threeparttable}[H]
	\caption{重现一部分\mci{SDCI关联能}所需的自旋、对称匹配组态的数目。体系为$\mathrm{H_2O}$, 基组为39-STO. 表中分别列出了使用正则轨道和自然轨道时的情况\tnote{a}。}
	\centering
	\begin{tabular}{ccc}
		\hline
		&\multicolumn{2}{c}{组态数目}\\\cline{2-3}
		占$E_\mathrm{corr}$的百分比&MO(分子轨道)&NO(自然轨道)\\\hline
		20&14&6 \\
		40&52&18 \\
		60&140&50\\
		80&351&147\\
		90&617&362\\
		99&1760&1652\\
		\hline
	\end{tabular}
	\begin{tablenotes}
		\item[a] I. Shavitt, B. J. Rosenberg, and S. Palalikit, \textit{Int. J. Quantum Chem.} \textbf{S10}: 33 (1976).
	\end{tablenotes}
\end{threeparttable}
\exercise{
在双电子系统这种特殊情形下，使用自然轨道能够显著减少Full CI展开的长度。若$\psi_1$是被占的\hft 空间轨道，$\psi_r$, $r=2,3,\ldots,K$时虚空间轨道，那么归一化的单重态full CI波函数可以写作
\begin{align*}
\ket{^1\Phi_0} = c_0\ket{1\bar{1}} + \sum_{r=2}^{K}c_1^r \ket{^1\Psi_1^r} + \frac{1}{2}\sum_{r=2}^{K}\sum_{s=2}^{K}c_{11}^{rs}\ket{^1\Psi_{11}^{rs}}
\end{align*}
式中的单、双激发自旋匹配组态已在\ref{sec2.5.2}中定义过。
\begin{enumerate}[a.]
	\item 证明$\ket{^1\Phi_0}$可以重新整理为如下形式
	\begin{align*}
	\ket{^1\Phi_0} = \sum_{i=1}^K\sum_{j=1}^K C_{ij}\ket{\psi_i\bar{\psi}_j}
	\end{align*}
	\item 证明
	\begin{align*}
	\gamma(\mathbf{x}_1,\mathbf{x}_1') = \sum_{ij} (\mathbf{CC^\dagger})_{ij} (\psi_i(1)\psi^*_j(1') + \bar{\psi}_i(1)\bar{\psi}_i^*(1))
	\end{align*}
	\item 令$\mathbf{U}$为对角化$\mathbf{C}$的酉变换：
	\begin{align*}
	\mathbf{U^\dagger CU} = \mathbf{d}
	\end{align*}
	其中$(\mathbf{d})_{ij}=d_i\delta_{ij}$. 请证明
	\begin{align*}
	\mathbf{U^\dagger CC\dagger U} = \mathbf{d}^2
	\end{align*}
	\item 请证明
	\begin{align*}
	\gamma(\mathbf{x}_1,\mathbf{x}_1') = \sum_i d_i^3 (\zeta_i(1)\zeta_i^*(1') + \bar{\zeta}_i(1)\bar{\zeta}_i^*(1'))
	\end{align*}
	式中
	\begin{align*}
	\zeta_i = \sum_k\psi_k U_{ki}
	\end{align*}
	因为$\mathbf{U}$对角化了\mci{一矩阵}，所以$\zeta_i$就是这个双电子体系的\mci{自然空间轨道}.
	\item 最后，由于$\mathbf{C}$是对称矩阵，$\mathbf{U}$可以选成实矩阵。请证明，按照\mci{自然空间轨道}, 上面a中给出的$\ket{^1\Phi_0}$可以重写为
	\begin{align*}
	\ket{^1\Phi_0} = \sum_{i=1}^{K}d_i\ket{\zeta_i\bar{\zeta}_i}
	\end{align*}
	注意这个写法中，展开式仅含$K$项。
\end{enumerate}
}
\section{多组态自洽场与广义价键法}
\section{截断CI与尺寸一致性问题}